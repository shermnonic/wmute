# param libraries
#
# lib param - base parameter library, based on boost::property_tree
# lib qparam - Qt4 parameter editor widget
#
# Max Hermann, August 2013

#---- Dependencies ------------------------------------------------------------

# Dependencies should already be included in master CMakeLists file. Depending 
# on which dependencies are met the corresponding sub-projects (libraries) are 
# built or not.

# Boost (required)
if( NOT Boost_FOUND )
	message(FATAL_ERROR "Package boost not found, but lib param requires boost::property_tree!")
endif( NOT Boost_FOUND )

# Qt4 (optional)
if( NOT QT_FOUND )
	message(WARNING "Package Qt not found, disabling depending library qparam.")
endif( NOT QT_FOUND )


#---- Libraries ---------------------------------------------------------------

#--- param lib (core parameter library) ---

set( param_INCLUDE_DIR "../include/param" )
set( param_SOURCE_DIR "." )
include_directories( "../include" )
include_directories( ${param_INCLUDE_DIR} )

add_library( param
	${param_SOURCE_DIR}/ParameterBase.cpp
	${param_SOURCE_DIR}/ParameterIO.cpp
	#ParameterBase.h
	#ParameterTypes.h
	#ParameterIO.h
)

#--- qparam lib (Qt user interface) ---

if( QT_FOUND )

	set( qlib_HEADER
		${param_INCLUDE_DIR}/PropertyTreeWidget.h
		${param_INCLUDE_DIR}/PropertyTreeDelegate.h
		${param_INCLUDE_DIR}/PropertyTreeView.h
		)
	set( qlib_SOURCE
		${param_SOURCE_DIR}/PropertyTreeWidget.cpp
		${param_SOURCE_DIR}/PropertyTreeDelegate.cpp
		${param_SOURCE_DIR}/PropertyTreeView.cpp
		)

	qt4_wrap_cpp( qlib_HEADER_MOC ${qlib_HEADER} )

	#ADD_DEFINITIONS(-DQPARAMS_LIB) # for shared libraries

	source_group("Autogenerated Moc files" FILES ${qlib_HEADER_MOC})

	add_library( qparam ${qlib_SOURCE} ${qlib_HEADER_MOC} ${qlib_HEADER} )
	
endif( QT_FOUND )
